CREATE DATABASE recetarium

CREATE TABLE public.ingredients(

    id_ingredient bigint NOT NULL DEFAULT nextval('ingredients_id_ingredient_seq'::regclass),
    name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    quantity double precision,
    measure character varying(50) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT ingredients_pkey PRIMARY KEY (id_ingredient)
)

CREATE TABLE public.recipes(

    id_recipe bigint NOT NULL DEFAULT nextval('recipes_id_recipe_seq'::regclass),
    name character varying COLLATE pg_catalog."default" NOT NULL,
    dificulty character varying COLLATE pg_catalog."default",
    time_required character varying COLLATE pg_catalog."default",
    description character varying COLLATE pg_catalog."default",
    instructions character varying COLLATE pg_catalog."default" NOT NULL,
    ingredients bigint NOT NULL,
    CONSTRAINT recipes_pkey PRIMARY KEY (id_recipe),
    CONSTRAINT ingredients_id_fkey FOREIGN KEY (id_recipe)
        REFERENCES public.ingredients (id_ingredient) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID
)

CREATE TABLE public.recipe_ingredient(

    id_recipe bigint NOT NULL,
    id_ingredient bigint NOT NULL,
    amount double precision NOT NULL DEFAULT 1,
    measure character varying COLLATE pg_catalog."default" NOT NULL DEFAULT 'unidad'::character varying,
    CONSTRAINT recipe_ingredient_pkey PRIMARY KEY (id_recipe, id_ingredient),
    CONSTRAINT recipe_ingredient_id_ingredient_fkey FOREIGN KEY (id_ingredient)
        REFERENCES public.ingredients (id_ingredient) MATCH SIMPLE
        ON UPDATE CASCADE
        ON DELETE NO ACTION,
    CONSTRAINT recipe_ingredient_id_recipe_fkey FOREIGN KEY (id_recipe)
        REFERENCES public.recipes (id_recipe) MATCH SIMPLE
        ON UPDATE CASCADE
        ON DELETE CASCADE
)